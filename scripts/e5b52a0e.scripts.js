!function(){"use strict";angular.module("boxpoolApp",["ngCookies","ui.bootstrap","mongolabResourceHttp"]).constant("MONGOLAB_CONFIG",{API_KEY:"503f0450e4b04102cdfdc589",DB_NAME:"dmo"}).constant("PASSWORD","kristal").constant("GENERIC_USER","http://citizenmed.files.wordpress.com/2011/08/user-icon1-e1313533162370.jpg?w=150&h=138").constant("ORDER_STATUS",[{id:1,name:"ORDERED","class":"icon-truck icon-flip-horizontal"},{id:2,name:"USA OFFICE","class":"icon-home"},{id:3,name:"SHIPPED PARTIAL","class":"icon-star-half-full"},{id:4,name:"CHINA OFFICE RECEIVED PARTIAL","class":"icon-flag-alt"},{id:5,name:"SHIPPED COMPLETE","class":"icon-plane"},{id:6,name:"CHINA OFFICE RECEIVED COMPLETE","class":"icon-flag"}]).factory("Page",["$mongolabResourceHttp",function(a){return a("pages")}]).factory("Category",["$mongolabResourceHttp",function(a){return a("categories")}]).factory("Product",["$mongolabResourceHttp",function(a){return a("products")}]).factory("Order",["$mongolabResourceHttp",function(a){return a("orders")}]).factory("User",["$mongolabResourceHttp",function(a){return a("users")}]).config(["$routeProvider",function(a){return a.when("/login",{templateUrl:"views/login.html"}).when("/",{templateUrl:"views/main.html",controller:"MainCtrl",resolve:{page:["Page",function(a){return a.query({name:"home"})}]}}).when("/products",{templateUrl:"views/product_list_full.html",controller:"ProductListCtrl",resolve:{products:["Product",function(a){return a.query()}]}}).when("/orders",{templateUrl:"views/order_list_full.html",controller:"OrderListCtrl",resolve:{orders:["Order",function(a){return a.query()}]}}).when("/pages",{templateUrl:"views/page_list.html",controller:"PageListCtrl",resolve:{pages:["Page",function(a){return a.all()}]}}).when("/pages/new",{templateUrl:"views/page_detail.html",controller:"PageCreateCtrl"}).when("/pages/:pageID",{templateUrl:"views/page_detail.html",controller:"PageEditCtrl"}).when("/categories",{templateUrl:"views/category_list.html",controller:"CategoryListCtrl",resolve:{categories:["Category",function(a){return a.all()}]}}).when("/categories/new",{templateUrl:"views/category_detail.html",controller:"CategoryCreateCtrl"}).when("/categories/:categoryID",{templateUrl:"views/category_detail.html",controller:"CategoryEditCtrl"}).when("/edit-products",{templateUrl:"views/product_list.html",controller:"ProductListCtrl",resolve:{products:["Product",function(a){return a.all()}]}}).when("/edit-products/new",{templateUrl:"views/product_detail.html",controller:"ProductCreateCtrl"}).when("/edit-products/:productID",{templateUrl:"views/product_detail.html",controller:"ProductEditCtrl"}).when("/edit-orders",{templateUrl:"views/order_list.html",controller:"OrderListCtrl",resolve:{orders:["Order","User",function(a,b){return a.all(function(a){var c;return c=_.uniq(_.pluck(a,"user")),b.getByObjectIds(c,function(b){return _.each(a,function(a){return a.user=_.find(b,function(b){return b._id.$oid===a.user})})})})}]}}).when("/edit-orders/new",{templateUrl:"views/order_detail.html",controller:"OrderCreateCtrl"}).when("/edit-orders/:orderID",{templateUrl:"views/order_detail.html",controller:"OrderEditCtrl"}).when("/edit-users",{templateUrl:"views/user_list.html",controller:"UserListCtrl",resolve:{users:["User",function(a){return a.all()}]}}).when("/edit-users/new",{templateUrl:"views/user_detail.html",controller:"UserCreateCtrl"}).when("/edit-users/:userID",{templateUrl:"views/user_detail.html",controller:"UserEditCtrl"}).otherwise({redirectTo:"/"})}])}.call(this),function(){"use strict";angular.module("boxpoolApp").controller("AppCtrl",["$scope","$location","Page","$cookies","PASSWORD","GENERIC_USER",function(a,b,c,d,e,f){return a.page={},a.admin=d.admin,a.genericUser=f,a.active=function(a){var c,d;return"/"===a?c=a===b.path():(d=new RegExp("^"+a),c=d.test(b.path())),c},a.login=function(){return a.admin="kristal"===a.page.username&&a.page.password===e,a.admin?(d.admin="admin",a.flash="",b.path("#/")):(d.admin="",a.flash="Invalid Login")},a.logout=function(){return d.admin="",a.admin=!!d.admin,b.path("#/")}}]).controller("MainCtrl",["$scope","page",function(a,b){return a.page=b[0]}])}.call(this),function(){"use strict";var a;a=angular.module("boxpoolApp"),a.controller("PageListCtrl",["$scope","Page",function(a,b){return a.pages=b.query()}]),a.controller("PageEditCtrl",["$scope","Page","$routeParams","$location",function(a,b,c,d){return b.getById(c.pageID,function(c){return self.original=c,a.page=new b(self.original)}),a.isClean=function(){return angular.equals(self.original,a.page)},a.destroy=function(){return confirm("Are you sure?")?self.original.$remove(function(){return d.path("/pages")}):void 0},a.save=function(){return a.page.$update(function(){return self.original=a.page,a.page=new b(self.original),d.path("/pages/"+a.page._id.$oid)})}}]),a.controller("PageCreateCtrl",["$scope","Page","$location",function(a,b,c){return a.page=new b,a.save=function(){return a.page.$save(function(a){return c.path("/pages/"+a._id.$oid)})}}])}.call(this),function(){"use strict";var a;a=angular.module("boxpoolApp"),a.controller("CategoryListCtrl",["$scope","categories",function(a,b){return a.categories=b}]),a.controller("CategoryEditCtrl",["$scope","Category","$routeParams","$location",function(a,b,c,d){return b.getById(c.categoryID,function(c){return self.original=c,a.category=new b(self.original)}),a.isClean=function(){return angular.equals(self.original,a.category)},a.destroy=function(){return confirm("Are you sure?")?self.original.$remove(function(){return d.path("/categories")}):void 0},a.save=function(){return a.category.$update(function(){return self.original=a.category,a.category=new b(self.original),d.path("/categories/"+a.category._id.$oid)})}}]),a.controller("CategoryCreateCtrl",["$scope","Category","$location",function(a,b,c){return a.category=new b,a.save=function(){return a.category.$save(function(a){return c.path("/categories/"+a._id.$oid)})}}])}.call(this),function(){"use strict";var a;a=angular.module("boxpoolApp"),a.controller("ProductListCtrl",["$scope","products","Category",function(a,b,c){return a.radio={},a.categories=c.all(function(b){return a.radio.category=b[0].code}),a.products=b}]),a.controller("ProductEditCtrl",["$scope","Category","Product","$routeParams","$location","$filter",function(a,b,c,d,e){return a.options=b.query(),c.getById(d.productID,function(b){var d;return self.original=b,a.product=new c(self.original),(d=a.product).category||(d.category=a.options[0].code)}),a.isClean=function(){return angular.equals(self.original,a.product)},a.destroy=function(){return confirm("Are you sure?")?self.original.$remove(function(){return e.path("/edit-products")}):void 0},a.save=function(){return a.product.$update(function(){return self.original=a.product,a.product=new c(self.original),e.path("/edit-products/"+a.product._id.$oid)})}}]),a.controller("ProductCreateCtrl",["$scope","Product","$location","Category",function(a,b,c,d){return a.product=new b,d.all(function(b){var c;return a.options=b,(c=a.product).category||(c.category=a.options[0].code)}),a.save=function(){return a.product.$save(function(a){return c.path("/edit-products/"+a._id.$oid)})}}])}.call(this),function(){"use strict";var a;a=angular.module("boxpoolApp"),a.controller("OrderListCtrl",["$scope","orders","ORDER_STATUS",function(a,b,c){return a.sortKey="-date",a.statuses=c,a.orders=b,a.saveStatus=function(a){var b;return b={},angular.copy(a,b),b.user=a.user._id.$oid,b.$update()}}]),a.controller("OrderEditCtrl",["$scope","Order","User","$routeParams","$location","ORDER_STATUS",function(a,b,c,d,e,f){return a.order={},b.getById(d.orderID,function(d){var e;return self.original=d,a.order=new b(self.original),(e=a.order).status||(e.status=a.options[0].code),c.getById(a.order.user,function(b){return a.userView=b,a.user=b.first+" "+b.last})}),a.statuses=f,a.$watch("user",function(){return angular.isObject(a.user)?(a.userView=a.user,a.order.user=a.user._id.$oid):void 0}),a.getUsers=function(a){return c.find(a)},a.isClean=function(){return angular.equals(self.original,a.order)},a.destroy=function(){return confirm("Delete record?")?self.original.$remove(function(){return e.path("/edit-orders")}):void 0},a.save=function(){return a.order.$update(function(){return self.original=a.order,a.order=new b(self.original),e.path("/edit-orders/"+a.order._id.$oid)})}}]),a.controller("OrderCreateCtrl",["$scope","Order","$location","Category","User","ORDER_STATUS",function(a,b,c,d,e,f){return a.order=new b,a.order.date=moment(),a.statuses=f,a.$watch("user",function(){return angular.isObject(a.user)?(a.userView=a.user,a.order.user=a.user._id.$oid):void 0}),a.getUsers=function(a){return e.find(a)},a.save=function(){return a.order.$save(function(a){return c.path("/edit-orders/"+a._id.$oid)})}}])}.call(this),function(){"use strict";var a;a=angular.module("boxpoolApp"),a.controller("UserListCtrl",["$scope","users",function(a,b){return a.users=b}]),a.controller("UserEditCtrl",["$scope","User","$routeParams","$location","$filter",function(a,b,c,d){return a.user={},b.getById(c.userID,function(c){return self.original=c,a.user=new b(self.original)}),a.isClean=function(){return angular.equals(self.original,a.user)},a.destroy=function(){return confirm("Are you sure?")?self.original.$remove(function(){return d.path("/edit-users")}):void 0},a.save=function(){return a.user.$update(function(){return self.original=a.user,a.user=new b(self.original),d.path("/edit-users/"+a.user._id.$oid)})}}]),a.controller("UserCreateCtrl",["$scope","User","$location","Category",function(a,b,c){return a.user=new b,a.genericUser="http://citizenmed.files.wordpress.com/2011/08/user-icon1-e1313533162370.jpg?w=150&h=138",a.user.date=moment(),a.save=function(){var b;return(b=a.user).imageUrl||(b.imageUrl=a.genericUser),a.user.$save(function(a){return c.path("/edit-users/"+a._id.$oid)})}}])}.call(this);